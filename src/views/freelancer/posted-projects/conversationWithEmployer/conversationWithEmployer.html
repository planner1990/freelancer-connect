<section class="chat-room">
  <v-container class="px-0 pt-4">
    <v-row class="justify-space-between pb-4 mx-1 header">
      <v-col
        class="pa-0 align-center d-flex align-center back-btn"
        @click="goBack"
      >
        <v-icon class="ml-3">mdi-arrow-right</v-icon>
        بازگشت
      </v-col>
    </v-row>
  </v-container>
  <v-container>
    <v-row class="mx-8">
      <v-col cols="12" class="pa-0 chat-box">
        <div class="d-flex justify-space-between chat-box-header">
          <div>
            <div class="chat-box-header-title">
              <v-icon color="#142226">mdi-message-text-outline</v-icon>
              قسمت گفتگو
            </div>
            <div class="chat-box-header-subject">{{authenticated.name}}</div>
          </div>
        </div>
        <div class="chat-box-body">
          <section ref="chatArea" class="chat-area ma-0">
            <p
              v-for="message in messages"
              class="message d-flex align-center"
              :class="{ 'message-out': message.role === 'freelancer', 'message-in': message.role === 'employer'}"
            >
              <img
                :src="authenticated.avatar !== null ? authenticated.avatar : require(`../../../../assets/image/connectalogo.png`)"
                v-if="message.role === 'freelancer'"
                alt="connecta"
                class="side-avatar"
              />
              <!--              <span-->
              <!--                class="d-block ml-auto"-->
              <!--                v-if="message.role === 'freelancer' "-->
              <!--              >-->
              <!--                <v-avatar>-->
              <!--                  <img-->
              <!--                    style="height: auto"-->
              <!--                    :src="message.avatar !== null ? message.avatar : require(`../../../../assets/image/connectalogo.png`)"-->
              <!--                    alt="connecta"-->
              <!--                  />-->
              <!--                </v-avatar>-->
              <!--                {{message.name}}</span-->
              <!--              >-->
              <span>
                <span class="d-block">{{ message.text }}</span>
                <span class="d-block">
                  <a
                    v-if="message.attachment && message.attachment.length >= 1"
                    :href="message.attachment"
                    download
                    target="_blank"
                    class="d-flex mt-4 attachment-link"
                  >
                    <img
                      src="../../../../assets/image/attachment-link.1.png"
                      alt=""
                    />
                    <span style="">دانلود پیوست</span>
                  </a>
                </span>
              </span>
              <span
                class="d-block mr-auto"
                v-if="message.role === 'employer' || message.role === 'admin'"
              >
                <img
                  :src="message.avatar !== null ? message.avatar : require(`../../../../assets/image/connectalogo.png`)"
                  alt="connecta"
                  class="side-avatar-answer"
                />
              </span>
            </p>
          </section>
        </div>
        <div class="chat-box-footer">
          <div class="chat-box-footer">
            <section class="chat-inputs">
              <form
                class="d-flex justify-space-between align-center"
                @submit.prevent="sendMessage('out')"
                id="person2-form"
                style="position: relative"
              >
                <v-col cols="10" class="mt-14 mx-auto ticket-input message-box">
                  <v-textarea
                    v-model="youMessage"
                    class="mt-14 col-10 mx-auto ticket-input message-box"
                    type="text"
                    label="پیام شما"
                    rows="2"
                    height="70"
                    outlined
                    dense
                    :append-icon="'mdi-paperclip'"
                    no-resize
                    @click:append="toggleFile"
                    @keyup.enter.prevent="sendMessage('out')"
                  >
                  </v-textarea>
                  <v-btn
                    depressed
                    class="send-ticket"
                    color="secondary"
                    large
                    type="submit"
                  >
                    <v-icon color="white" size="20">
                      mdi-arrow-up
                    </v-icon>
                  </v-btn>
                </v-col>
                <v-file-input
                  @change="getFileInput($event)"
                  v-model="fileInput"
                  id="avatar"
                  prepend-icon="mdi-paperclip"
                  outlined
                  style="position: absolute;top: -26px;right: 88px;width: 73%;"
                  :class="{ 'isShow': isShow === true, 'isNone': isShow === false }"
                  dense
                  multiple
                  small-chips
                  :show-size="1000"
                >
                  <template v-slot:selection="{ index, text }">
                    <v-chip v-if="index < 2" dark label small>
                      {{ text }}
                    </v-chip>
                    <span
                      v-else-if="index === 2"
                      class="text-overline grey--text text--darken-3 mx-2"
                    >
                      +{{ fileInput.length - 2 }} File(s)
                    </span>
                  </template>
                </v-file-input>
              </form>
            </section>
          </div>
        </div>
      </v-col>
    </v-row>
    <v-row>
      <snackbar
        :snackbarMessage="snackbarMessage"
        :showSnackbar="showSnackbar"
        @hideSnackbar="hideSnackbar"
      ></snackbar>
    </v-row>
  </v-container>
</section>
